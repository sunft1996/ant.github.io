(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{FIaZ:function(e,t,a){"use strict";a.r(t);var n,l,r,o,i,c,d,s,u,p,h,m,f,y=a("jehZ"),b=a.n(y),k=(a("IzEo"),a("bx4M")),v=(a("qVdP"),a("jsC+")),C=(a("Pwec"),a("CtXQ")),E=(a("+L6B"),a("2/Rp")),g=(a("lUTK"),a("BvKs")),V=(a("2qtc"),a("kLXV")),w=(a("5NDa"),a("5rEg")),M=a("p0pE"),S=a.n(M),R=(a("miYZ"),a("tsqr")),T=a("2Taf"),I=a.n(T),D=a("vZ4D"),N=a.n(D),U=a("MhPg"),x=a.n(U),F=a("l4Ni"),K=a.n(F),O=a("ujKo"),A=a.n(O),q=(a("ozfa"),a("MJZm")),P=(a("y8nQ"),a("Vl3Y")),j=a("q1tI"),L=a.n(j),z=a("MuoO"),B=a("CkN6"),Z=a("zHco"),J=a("dWUB"),Q=a.n(J);function X(e){var t=Y();return function(){var a,n=A()(e);if(t){var l=A()(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return K()(this,a)}}function Y(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}var H=P["a"].Item,W=q["a"].TreeNode,_=(n=Object(z["connect"])(function(e){var t=e.menu,a=e.role;return{menu:t,role:a}}),l=P["a"].create(),n(r=l(r=function(e){x()(a,e);var t=X(a);function a(e){var n;return I()(this,a),n=t.call(this,e),n.handleCheck=function(e,t){n.setState({checkedKeys:e.checked.map(function(e){return Number(e)})})},n.renderTreeNodes=function(e){return e.map(function(e){return e.childData?L.a.createElement(W,{title:e.name,key:e.id,dataRef:e},n.renderTreeNodes(e.childData)):L.a.createElement(W,{title:e.name,key:e.id,dataRef:e})})},n.state={checkedKeys:[]},n}return N()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"menu/fetchAll"})}},{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.form,n=e.handleAdd,l=e.handleModalVisible,r=e.menu,o=e.role.loading,i=this.state.checkedKeys,c=function(){a.validateFields(function(e,t){if(!e)if(0!==i.length){var l=S()({},t,{menuIds:i});n(l,a)}else R["a"].error("\u8bf7\u9009\u62e9\u53ef\u8bbf\u95ee\u9875\u9762")})},d=Array.isArray(r.allmenus)?r.allmenus:[];return L.a.createElement(V["a"],{maskClosable:!1,destroyOnClose:!0,width:840,title:"\u65b0\u5efa\u89d2\u8272",visible:t,onOk:c,onCancel:function(){return l()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",confirmLoading:o},L.a.createElement(H,{labelCol:{span:5},wrapperCol:{span:15},label:"\u89d2\u8272\u540d"},a.getFieldDecorator("description",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63cf\u8ff0\uff01"}]})(L.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),L.a.createElement(H,{labelCol:{span:5},wrapperCol:{span:15},label:"\u6743\u9650"},a.getFieldDecorator("role",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6743\u9650\uff01"}]})(L.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),L.a.createElement(H,{labelCol:{span:5},wrapperCol:{span:15},label:"\u53ef\u8bbf\u95ee\u9875\u9762"},a.getFieldDecorator("menuIds",{})(L.a.createElement(q["a"],{checkedKeys:i,onCheck:this.handleCheck,checkable:!0,checkStrictly:!0},this.renderTreeNodes(d)))))}}]),a}(j["PureComponent"]))||r)||r),G=(o=Object(z["connect"])(function(e){var t=e.menu,a=e.role;return{menu:t,role:a}}),i=P["a"].create(),o(c=i((s=d=function(e){x()(a,e);var t=X(a);function a(e){var n;return I()(this,a),n=t.call(this,e),n.handleCheck=function(e,t){n.setState({checkedKeys:e.checked.map(function(e){return Number(e)})})},n.renderTreeNodes=function(e){return e.map(function(e){return e.childData?L.a.createElement(W,{title:e.name,key:e.id,dataRef:e},n.renderTreeNodes(e.childData)):L.a.createElement(W,{title:e.name,key:e.id,dataRef:e})})},n.state={checkedKeys:[]},n}return N()(a,[{key:"componentDidMount",value:function(){var e=this.props.record;this.setState({checkedKeys:e.menuId.split(",")})}},{key:"render",value:function(){var e=this.props,t=e.updateModalVisible,a=e.handleUpdateModalVisible,n=e.handleUpdate,l=e.values,r=e.form,o=e.record,i=e.menu,c=e.role.loading,d=this.state.checkedKeys,s=function(){r.validateFields(function(e,t){if(!e)if(0!==d.length){r.resetFields();var a=S()({},t,{menuIds:d});o.id&&n(a,o.id)}else R["a"].error("\u8bf7\u9009\u62e9\u53ef\u8bbf\u95ee\u9875\u9762")})},u=Array.isArray(i.allmenus)?i.allmenus:[];return L.a.createElement(V["a"],{maskClosable:!1,width:840,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u7f16\u8f91\u89d2\u8272",visible:t,onOk:s,onCancel:function(){return a(!1,l)},afterClose:function(){return a()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",confirmLoading:c},L.a.createElement(H,{labelCol:{span:5},wrapperCol:{span:15},label:"\u89d2\u8272\u540d"},r.getFieldDecorator("description",{initialValue:o.description,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63cf\u8ff0\uff01"}]})(L.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),L.a.createElement(H,{labelCol:{span:5},wrapperCol:{span:15},label:"\u6743\u9650"},r.getFieldDecorator("role",{initialValue:o.role,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6743\u9650\uff01"}]})(L.a.createElement(w["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),L.a.createElement(H,{labelCol:{span:5},wrapperCol:{span:15},label:"\u53ef\u8bbf\u95ee\u9875\u9762"},r.getFieldDecorator("menuIds",{})(L.a.createElement(q["a"],{checkable:!0,checkedKeys:d,onCheck:this.handleCheck,checkStrictly:!0},this.renderTreeNodes(u)))))}}]),a}(j["Component"]),d.defaultProps={handleUpdate:function(){},handleUpdateModalVisible:function(){},values:{},record:{}},c=s))||c)||c),$=(u=Object(z["connect"])(function(e){var t=e.role,a=e.menu;return{role:t,menu:a}}),p=P["a"].create(),u(h=p((f=m=function(e){x()(a,e);var t=X(a);function a(){var e;I()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return e=t.call.apply(t,[this].concat(l)),e.state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:{},record:{}},e.columns=[{title:"\u89d2\u8272\u540d",dataIndex:"description",key:"description"},{title:"\u6743\u9650",dataIndex:"role",key:"role"},{title:"\u64cd\u4f5c",render:function(t,a){return L.a.createElement(j["Fragment"],null,L.a.createElement("a",{onClick:function(){return e.handleUpdateModalVisible(!0,a)}},"\u7f16\u8f91"))}}],e.handleStandardTableChange=function(t,a){var n=e.props.dispatch,l=e.state.formValues,r=S()({currentPage:t.current,pageSize:t.pageSize},l);a.field&&(r.sorter="".concat(a.field,"_").concat(a.order)),n({type:"role/fetch",payload:r})},e.handleFormReset=function(){var t=e.props,a=t.form,n=t.dispatch;a.resetFields(),e.setState({formValues:{}}),n({type:"role/fetch",payload:{}})},e.handleMenuClick=function(t){var a=e.props.dispatch,n=e.state.selectedRows;if(0!==n.length){var l=n.map(function(e){return e.id});switch(t.key){case"remove":V["a"].confirm({title:"\u786e\u5b9a\u5220\u9664\u5417\uff1f",onOk:function(){a({type:"role/remove",payload:l,callback:function(){e.setState({selectedRows:[]})}})},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"});break;default:break}}},e.handleSelectRows=function(t){e.setState({selectedRows:t})},e.handleModalVisible=function(t){e.setState({modalVisible:!!t})},e.handleUpdateModalVisible=function(t,a){e.setState({updateModalVisible:!!t,record:a||{}})},e.handleAdd=function(t,a){var n=e.props.dispatch;n({type:"role/add",payload:{description:t.description,role:t.role,menuIds:t.menuIds}}).then(function(t){"SUCCESS"===t.code&&(a.resetFields(),e.handleModalVisible())})},e.handleUpdate=function(t,a){var n=e.props.dispatch;n({type:"role/update",payload:{description:t.description,role:t.role,menuIds:t.menuIds,id:a}}),e.handleUpdateModalVisible()},e}return N()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"role/fetch"})}},{key:"render",value:function(){var e=this,t=this.props.role,a=t.list,n=this.state,l=n.selectedRows,r=n.modalVisible,o=n.updateModalVisible,i=n.record,c=L.a.createElement(g["a"],{onClick:this.handleMenuClick,selectedKeys:[]},L.a.createElement(g["a"].Item,{key:"remove"},"\u5220\u9664")),d={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},s={handleUpdateModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return L.a.createElement(Z["a"],{title:"\u89d2\u8272\u7ba1\u7406"},L.a.createElement(k["a"],{bordered:!1},L.a.createElement("div",{className:Q.a.tableList},L.a.createElement("div",{className:Q.a.tableListOperator},L.a.createElement(E["a"],{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"\u65b0\u5efa"),l.length>0&&L.a.createElement(v["a"],{overlay:c},L.a.createElement(E["a"],null,"\u66f4\u591a\u64cd\u4f5c ",L.a.createElement(C["a"],{type:"down"})))),L.a.createElement(B["a"],{rowKey:"id",rowClassName:"textCenter",selectedRows:l,loading:t.loading,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),L.a.createElement(_,b()({},d,{modalVisible:r,roleList:a,values:i})),i&&Object.keys(i).length?L.a.createElement(G,b()({},s,{record:i,updateModalVisible:o})):null)}}]),a}(j["Component"]),m.defaultProps={role:{list:[]}},h=f))||h)||h);t["default"]=$}}]);