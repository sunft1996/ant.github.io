(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{FIaZ:function(e,t,a){"use strict";a.r(t);var n,l,r,o,i,c,d,s,u,p,h,m,f,y,b=a("jehZ"),k=a.n(b),v=(a("IzEo"),a("bx4M")),C=(a("qVdP"),a("jsC+")),E=(a("Pwec"),a("CtXQ")),g=(a("+L6B"),a("2/Rp")),V=(a("lUTK"),a("BvKs")),w=(a("2qtc"),a("kLXV")),M=(a("5NDa"),a("5rEg")),S=a("p0pE"),R=a.n(S),D=(a("miYZ"),a("tsqr")),T=a("2Taf"),I=a.n(T),N=a("vZ4D"),U=a.n(N),x=a("MhPg"),F=a.n(x),K=a("l4Ni"),O=a.n(K),A=a("ujKo"),q=a.n(A),P=(a("ozfa"),a("MJZm")),j=(a("y8nQ"),a("Vl3Y")),L=a("q1tI"),z=a.n(L),Z=a("MuoO"),B=a("CkN6"),J=a("zHco"),Q=a("dWUB"),X=a.n(Q);function Y(e){var t=H();return function(){var a,n=q()(e);if(t){var l=q()(this).constructor;a=Reflect.construct(n,arguments,l)}else a=n.apply(this,arguments);return O()(this,a)}}function H(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var W=j["a"].Item,_=P["a"].TreeNode,G=(n=Object(Z["connect"])(function(e){var t=e.menu,a=e.role;return{menu:t,role:a}}),l=j["a"].create(),n(r=l((o=function(e){F()(a,e);var t=Y(a);function a(e){var n;return I()(this,a),n=t.call(this,e),n.handleCheck=function(e,t){n.setState({checkedKeys:e.checked.map(function(e){return Number(e)})})},n.renderTreeNodes=function(e){return e.map(function(e){return e.childData?z.a.createElement(_,{title:e.name,key:e.id,dataRef:e},n.renderTreeNodes(e.childData)):z.a.createElement(_,{title:e.name,key:e.id,dataRef:e})})},n.state={checkedKeys:[]},n}return U()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"menu/fetchAll"})}},{key:"render",value:function(){var e=this.props,t=e.modalVisible,a=e.form,n=e.handleAdd,l=e.handleModalVisible,r=e.menu,o=e.role.loading,i=this.state.checkedKeys,c=function(){a.validateFields(function(e,t){if(!e)if(0!==i.length){var l=R()({},t,{menuIds:i});n(l,a)}else D["a"].error("\u8bf7\u9009\u62e9\u53ef\u8bbf\u95ee\u9875\u9762")})},d=Array.isArray(r.allmenus)?r.allmenus:[];return z.a.createElement(w["a"],{maskClosable:!1,destroyOnClose:!0,width:840,title:"\u65b0\u5efa\u89d2\u8272",visible:t,onOk:c,onCancel:function(){return l()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",confirmLoading:o},z.a.createElement(W,{labelCol:{span:5},wrapperCol:{span:15},label:"\u89d2\u8272\u540d"},a.getFieldDecorator("description",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63cf\u8ff0\uff01"}]})(z.a.createElement(M["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),z.a.createElement(W,{labelCol:{span:5},wrapperCol:{span:15},label:"\u6743\u9650"},a.getFieldDecorator("role",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6743\u9650\uff01"}]})(z.a.createElement(M["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),z.a.createElement(W,{labelCol:{span:5},wrapperCol:{span:15},label:"\u53ef\u8bbf\u95ee\u9875\u9762"},a.getFieldDecorator("menuIds",{})(z.a.createElement(P["a"],{checkedKeys:i,onCheck:this.handleCheck,checkable:!0,checkStrictly:!0},this.renderTreeNodes(d)))))}}]),a}(L["PureComponent"]),r=o))||r)||r),$=(i=Object(Z["connect"])(function(e){var t=e.menu,a=e.role;return{menu:t,role:a}}),c=j["a"].create(),i(d=c((u=s=function(e){F()(a,e);var t=Y(a);function a(e){var n;return I()(this,a),n=t.call(this,e),n.handleCheck=function(e,t){n.setState({checkedKeys:e.checked.map(function(e){return Number(e)})})},n.renderTreeNodes=function(e){return e.map(function(e){return e.childData?z.a.createElement(_,{title:e.name,key:e.id,dataRef:e},n.renderTreeNodes(e.childData)):z.a.createElement(_,{title:e.name,key:e.id,dataRef:e})})},n.state={checkedKeys:[]},n}return U()(a,[{key:"componentDidMount",value:function(){var e=this.props.record;this.setState({checkedKeys:e.menuId.split(",")})}},{key:"render",value:function(){var e=this.props,t=e.updateModalVisible,a=e.handleUpdateModalVisible,n=e.handleUpdate,l=e.values,r=e.form,o=e.record,i=e.menu,c=e.role.loading,d=this.state.checkedKeys,s=function(){r.validateFields(function(e,t){if(!e)if(0!==d.length){r.resetFields();var a=R()({},t,{menuIds:d});o.id&&n(a,o.id)}else D["a"].error("\u8bf7\u9009\u62e9\u53ef\u8bbf\u95ee\u9875\u9762")})},u=Array.isArray(i.allmenus)?i.allmenus:[];return z.a.createElement(w["a"],{maskClosable:!1,width:840,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u7f16\u8f91\u89d2\u8272",visible:t,onOk:s,onCancel:function(){return a(!1,l)},afterClose:function(){return a()},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",confirmLoading:c},z.a.createElement(W,{labelCol:{span:5},wrapperCol:{span:15},label:"\u89d2\u8272\u540d"},r.getFieldDecorator("description",{initialValue:o.description,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63cf\u8ff0\uff01"}]})(z.a.createElement(M["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),z.a.createElement(W,{labelCol:{span:5},wrapperCol:{span:15},label:"\u6743\u9650"},r.getFieldDecorator("role",{initialValue:o.role,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6743\u9650\uff01"}]})(z.a.createElement(M["a"],{placeholder:"\u8bf7\u8f93\u5165"}))),z.a.createElement(W,{labelCol:{span:5},wrapperCol:{span:15},label:"\u53ef\u8bbf\u95ee\u9875\u9762"},r.getFieldDecorator("menuIds",{})(z.a.createElement(P["a"],{checkable:!0,checkedKeys:d,onCheck:this.handleCheck,checkStrictly:!0},this.renderTreeNodes(u)))))}}]),a}(L["Component"]),s.defaultProps={handleUpdate:function(){},handleUpdateModalVisible:function(){},values:{},record:{}},d=u))||d)||d),ee=(p=Object(Z["connect"])(function(e){var t=e.role,a=e.menu;return{role:t,menu:a}}),h=j["a"].create(),p(m=h((y=f=function(e){F()(a,e);var t=Y(a);function a(){var e;I()(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return e=t.call.apply(t,[this].concat(l)),e.state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],formValues:{},record:{}},e.columns=[{title:"\u89d2\u8272\u540d",dataIndex:"description",key:"description"},{title:"\u6743\u9650",dataIndex:"role",key:"role"},{title:"\u64cd\u4f5c",render:function(t,a){return z.a.createElement(L["Fragment"],null,z.a.createElement("a",{onClick:function(){return e.handleUpdateModalVisible(!0,a)}},"\u7f16\u8f91"))}}],e.handleStandardTableChange=function(t,a){var n=e.props.dispatch,l=e.state.formValues,r=R()({currentPage:t.current,pageSize:t.pageSize},l);a.field&&(r.sorter="".concat(a.field,"_").concat(a.order)),n({type:"role/fetch",payload:r})},e.handleFormReset=function(){var t=e.props,a=t.form,n=t.dispatch;a.resetFields(),e.setState({formValues:{}}),n({type:"role/fetch",payload:{}})},e.handleMenuClick=function(t){var a=e.props.dispatch,n=e.state.selectedRows;if(0!==n.length){var l=n.map(function(e){return e.id});switch(t.key){case"remove":w["a"].confirm({title:"\u786e\u5b9a\u5220\u9664\u5417\uff1f",onOk:function(){a({type:"role/remove",payload:l,callback:function(){e.setState({selectedRows:[]})}})},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"});break;default:break}}},e.handleSelectRows=function(t){e.setState({selectedRows:t})},e.handleModalVisible=function(t){e.setState({modalVisible:!!t})},e.handleUpdateModalVisible=function(t,a){e.setState({updateModalVisible:!!t,record:a||{}})},e.handleAdd=function(t,a){var n=e.props.dispatch;n({type:"role/add",payload:{description:t.description,role:t.role,menuIds:t.menuIds}}).then(function(t){"SUCCESS"===t.code&&(a.resetFields(),e.handleModalVisible())})},e.handleUpdate=function(t,a){var n=e.props.dispatch;n({type:"role/update",payload:{description:t.description,role:t.role,menuIds:t.menuIds,id:a}}),e.handleUpdateModalVisible()},e}return U()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"role/fetch"})}},{key:"render",value:function(){var e=this,t=this.props.role,a=t.list,n=this.state,l=n.selectedRows,r=n.modalVisible,o=n.updateModalVisible,i=n.record,c=z.a.createElement(V["a"],{onClick:this.handleMenuClick,selectedKeys:[]},z.a.createElement(V["a"].Item,{key:"remove"},"\u5220\u9664")),d={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},s={handleUpdateModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return z.a.createElement(J["a"],{title:"\u89d2\u8272\u7ba1\u7406"},z.a.createElement(v["a"],{bordered:!1},z.a.createElement("div",{className:X.a.tableList},z.a.createElement("div",{className:X.a.tableListOperator},z.a.createElement(g["a"],{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"\u65b0\u5efa"),l.length>0&&z.a.createElement(C["a"],{overlay:c},z.a.createElement(g["a"],null,"\u66f4\u591a\u64cd\u4f5c ",z.a.createElement(E["a"],{type:"down"})))),z.a.createElement(B["a"],{rowKey:"id",rowClassName:"textCenter",selectedRows:l,loading:t.loading,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),z.a.createElement(G,k()({},d,{modalVisible:r,roleList:a,values:i})),i&&Object.keys(i).length?z.a.createElement($,k()({},s,{record:i,updateModalVisible:o})):null)}}]),a}(L["Component"]),f.defaultProps={role:{list:[]}},m=y))||m)||m);t["default"]=ee}}]);